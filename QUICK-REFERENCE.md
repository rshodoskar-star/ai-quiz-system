# ⚡ Quick Reference – AI Quiz System

## الحالة الحالية في نقاط
- **البيئة الحالية:** الإصدار الإنتاجي V7.0 يعمل في موقع الاختبار ويستخدم `PyMuPDF` للوضع "text".
- **التغطية:** ينتج حوالي 70 % من الأسئلة الصحيحة بسبب فقدان تخطيط الصفحات متعددة الأعمدة.
- **الجودة:** الأسئلة الناتجة جيدة غالباً لكن بعض المعلومات مفقودة أو مرتبة بشكل خاطئ.
- **OCR:** لا يتم استخدام OCR في V7.0؛ الصفحات الممسوحة ضوئياً تعطي نصاً فارغاً.

## المشكلة بإيجاز
ملفات PDF التعليمية غالباً ما تحتوي على أعمدة وجداول وعناوين لا يمكن تفسيرها جيداً باستخدام `page.get_text("text")`.  ينتج عن ذلك نص غير مرتب يفقد أجزاء من المحتوى، ما يحد من عدد الأسئلة التي يمكن توليدها.

## الحل المقترح
- استخدم `page.get_text("dict")` من PyMuPDF لاستخراج النص مع إحداثياته (Layout).
- قم بفرز الكتل (blocks) حسب ترتيب الإحداثيات `(y, -x)` لدعم النص العربي من اليمين لليسار.
- عند اكتشاف صفحة ممسوحة (نص قصير + وجود صور) استخدم OCR (مثل **PaddleOCR**) لاستخراج النص.
- نظف النص بعد الاستخراج: أزل التشكيل، وحدد أحرف الألف، وأصلح المسافات والأسطر، واستخدم `ftfy` لإصلاح ترميز UTF‑8.
- حدّث ملف Docker لتثبيت مكتبات النظام المطلوبة (libGL, libSM وغيرها) واستخدم `opencv-python-headless` مع PaddlePaddle.

## البحث المطلوب
لمعرفة المزيد حول هذه التقنيات، ابدأ بـ **RESEARCH-GUIDE.md** الذي يحتوي على:
- كلمات مفتاحية للبحث مثل "PyMuPDF dict", "PDF layout analysis", "PaddleOCR", "RTL text extraction".
- روابط أبحاث مثل [AdaParse](https://arxiv.org/abs/2505.01435) و [V‑Doc](https://arxiv.org/abs/2205.13724).
- مكتبات وأطر عمل مفيدة.

## الملفات الجاهزة
- **الإنتاج الحالي:** `server-v7.0-PYMUPDF.js`, `extract_pdf.py`, `Dockerfile`, `requirements.txt`, `package.json`.
- **المخطط (V8):** `server-v8-FIXED.js`, `extract_pdf-v8-FIXED.py`, `Dockerfile-v8-FINAL`, `requirements-v8-simple.txt`, `package-v8-clean.json`. *(قيد الاختبار)*

## مقارنة سريعة
| الإصدار | التغطية | التخطيط | OCR | الحالة |
|---------|---------|---------|-----|--------|
| **V7.0** | ~70% | ❌ | ❌ | إنتاج |
| **V8.0** | +95% | ✅ | ✅ | جاهز للاختبار |

---

اطلع على **PROJECT-COMPLETE-DOCUMENTATION.md** للتفاصيل الكاملة. عند بدء البحث، ارجع إلى **RESEARCH-GUIDE.md** واستخدم **CODE-SNIPPETS.md** لتجربة الكود المحلي.
